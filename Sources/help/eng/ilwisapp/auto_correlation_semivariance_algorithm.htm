<html>

<head>
<title>Autocorrelation - Semivariance : algorithm</title>
<meta name="author" content="Petra Budde, Raymond Nijmeijer">
<meta name="keywords" content="Autocorrelation, Semi-variance">
<link rel=stylesheet type="text/css" href="../ilwis.css">
</head>
<body text="#000000" bgcolor="#FFFFFF">

<h1 class=firstline>Autocorrelation - Semivariance</h1>

<h1 class=secondline>Algorithm</h1>

<!--<hr>-->

<p class=defnewpar>AutoCorrelation calculates autocorrelation and semi-variogram values for a raster map. The autocorrelation of a raster map is generated by calculating the correlation between pixel values of a raster map and pixel values of the same raster map for different shifts (lags) in horizontal or vertical directions. The semi-variogram values which are a measure of the spatial variability within a raster map are calculated for the same shifts. </p>

<p class=defnewpar>For each record in the output table, i.e. for all pixels that have a certain distance towards each other, the horizontal and vertical autocorrelation values, and horizontal and vertical semi-variogram values are calculated as:</p>

<p class=emptyline>&nbsp;&nbsp; </p>

<p><img src="../images/f2autoc.gif" align=bottom width="444" height="47"></p>

<p class=emptyline>&nbsp;&nbsp; </p>
       
<p><img src="../images/f2semiv.gif" align=bottom width="361" height="40"></p>

<p class=defnewpar>where:	</p>

<table cellspacing=0>
<tr>
<td valign="top" width=96>
<p><i>n</i></p>

</td>
<td valign="top">
<p>number of terms in the summations</p>

</td>
</tr>
<tr>
<td valign="top" width=96>
<p><i>a(p)</i></p>

</td>
<td valign="top">
<p>pixel value at position p in the input map</p>

</td>
</tr>
<tr>
<td valign="top" width=96>
<p><i>a(p+h)</i></p>

</td>
<td valign="top">
<p>pixel value at position p+h in the input map; this is h pixels further in either horizontal (row) or vertical (column) direction</p>

</td>
</tr>
<tr>
<td valign="top" width=96>
<p><span class=symbol><i>S</i></span></p>

</td>
<td valign="top">
<p>summation over all pixels for which both a(p) and a(p+h) are defined.</p>

</td>
</tr>
</table>

<p class=kopje>Pixel shift:</p>

<p>The default value for the maximum pixel shift is usually 20. This means that correlations and experimental semi-variogram values will be calculated in horizontal and vertical directions for pixel pairs that are 1, 2, 3, until <i>20 pixels</i> apart. The output table will contain 20 records; the record numbers imply the pixel shift. The Distance column gives the distance in meters; Distance = record number <span class=courier>*</span> pixel size of map. </p>

<ul>

<li>	For maps where either the number of rows or the number of columns is less than 100, a smaller default for the maximum pixel shift is provided. </li>

<li>	The maximum value that will accepted for the maximum pixel shift is the number of rows in your map or the number of columns in your map (the largest of these). Obviously, pixel pairs can only be found until a maximum pixel shift equal to the number of rows (= NrRows -1) for the calculations in vertical direction, and until the number of columns (= NrCols -1) for calculations in horizontal direction. </li>

<li>	Furthermore, for very large raster maps, the absolute limitation for the maximum pixel shift of 8000 pixels.</li>

</ul>

<p class=tip>Mind: </p>

<p class=tiptext>Using a small value for the maximum pixel shift will increase calculation speed for this operation as less records need to be calculated. </p>

<p class=kopje>Example:</p>

<p>When a map has 200 rows and 300 columns, the maximum pixel shift that you can specify is 300. The output table will then contain 300 records. The maximum pixel shift for which horizontal autocorrelations and semi-variogram values can be calculated is 299 (pixel in first column to pixel in last column); for the horizontal columns record 300 will thus remain empty. The columns containing vertical autocorrelations and semi-variogram values will be filled up to record 199 as this is the maximum vertical distance between pixels in the map. </p>

<p class=kopje>Process:</p>

<p>First, horizontal pixel pairs will be found for all horizontal distances. </p>

<p>For all pixel pairs which are a <i>horizontal</i> distance of 1 pixel apart, the horizontal autocorrelation value and the  horizontal semi-variogram value are calculated. The answers appear in the first record of the table.</p>

<p>This is then repeated for all pixel pairs that are a horizontal distance of 2 pixels apart from each other, etc., either until the distance becomes so large that no more pixel pairs can be found for that distance or until the user-specified maximum pixel shift minus 1 is reached.</p>

<p>Next, internally using MirrorRotate, the map is <i>rotated</i> 90°, and the calculations are repeated for all pixel shifts. These answers will appear in the columns containing the autocorrelations and semi-variogram values for <i>vertical</i> distances.</p>

<p class=Seealso>See also:</p>

<p class=seealsolinks><a href="../ilwisapp/auto_correlation_semivariance_functionality.htm">Autocorrelation - Semivariance : functionality</a></p>

<p class=seealsolinks><a href="../ilwisapp/spatial_correlation_functionality.htm">Spatial correlation : functionality</a></p>

</body